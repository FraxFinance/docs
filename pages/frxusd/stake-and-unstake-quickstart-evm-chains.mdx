---
title: Stake & Unstake frxUSD on EVM chains
lang: en-US
---

# Stake & Unstake frxUSD on EVM chains

This guide shows how to use the viem framework to **stake frxUSD for sfrxUSD** and **unstake sfrxUSD back to frxUSD** on EVM chains. We'll use **Base mainnet** as our example.

To see a list of all supported networks, see the [Stake & Unstake Supported Networks and EIDs](/frxusd/stake-and-unstake-supported-networks) page.

## Prerequisites

Before you start building the sample app to perform frxUSD staking operations, ensure you have met the following prerequisites:

1. **Install Node.js and npm**

   - Download and install **Node.js** directly or use a version manager like **nvm**.
   - **npm** is included with Node.js.

2. **Set up a non-custodial wallet** (for example, MetaMask)

   - You can download, install, and create a **MetaMask** wallet from its official website.
   - During setup, create a wallet on **Base mainnet**.
   - Retrieve the **private key** for your wallet, as it will be required in the script below.

3. **Fund your wallet with the gas token on the chain you want to stake from**

   - For this guide, we will be staking and unstaking frxUSD on **Base mainnet**. Therefore, you will need to fund your wallet with **ETH** on **Base mainnet**.

## Project setup

To build the script, first set up your project environment and install the required dependencies.

### 1. Set up a new project

Create a new directory and initialize a new `Node.js` project with default settings:

```shell
mkdir frxusd-staking-base
cd frxusd-staking-base
npm init -y
```

This also creates a default `package.json` file.

### 2. Install dependencies

In your project directory, install the required dependencies, including `viem`:

```shell
npm install dotenv@^16.4.7 viem@^2.23.4
```

This sets up your development environment with the necessary libraries for building the script. It also updates the `package.json` file with the dependencies.

### 3. Add module type

Add `"type": "module"` to the `package.json` file:

```json
{
  "name": "frxusd-staking-base",
  "version": "1.0.0",
  "type": "module",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "start": "node stake-and-unstake.js"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "description": "",
  "dependencies": {
    "dotenv": "^16.4.7",
    "viem": "^2.23.4"
  }
}
```

### 4. Configure environment variables

Create a `.env` file in your project directory and add your wallet private key:

```shell
echo "PRIVATE_KEY=your-private-key-here" > .env
```

**Warning:** This is strictly for testing purposes. **Never share your private key**.

## Script setup

This section covers the necessary setup for the staking script, including defining contract addresses for Base mainnet and configuring the wallet client.

### 1. Contract addresses and configuration

The script defines addresses for **Base mainnet**:

```javascript
// ============ Configuration Constants ============

// Authentication
const PRIVATE_KEY = process.env.PRIVATE_KEY;
const account = privateKeyToAccount(`0x${PRIVATE_KEY}`);

// Hop Contract Address
const BASE_MAINNET_HOP_ADDRESS = '0x73382eb28F35d80Df8C3fe04A3EED71b1aFce5dE';

// frxUSD and sfrxUSD Contract Addresses
const BASE_MAINNET_FRXUSD_ADDRESS = '0xe5020A6d073a794B6E7f05678707dE47986Fb0b6';
const BASE_MAINNET_SFRXUSD_ADDRESS = '0x91A3f8a8d7a881fBDfcfEcd7A2Dc92a46DCfa14e';

// Staking Parameters
const STAKE_AMOUNT = 10_000_000_000_000_000_000n; // 10 frxUSD (18 decimals)
const UNSTAKE_AMOUNT = 10_000_000_000_000_000_000n; // 10 sfrxUSD (18 decimals)
```

### 2. Set up wallet client

The script creates a wallet client for Base network:

```javascript
// Set up wallet client for Base network
const baseClient = createWalletClient({
  chain: base,
  transport: http(),
  account,
});
```

## frxUSD staking process

The following sections outline the staking and unstaking logic for Base network. The process involves:

1. **Approving frxUSD** for the Hop contract to stake frxUSD
2. **Staking frxUSD** to receive sfrxUSD
3. **Approving sfrxUSD** for the Hop contract to unstake sfrxUSD
4. **Unstaking sfrxUSD** to receive frxUSD back

### 1. Approve frxUSD for staking

Before staking, approve frxUSD for the Hop contract so it can pull frxUSD from your wallet:

```javascript
async function approveFrxusdForStaking() {
  console.log(`Approving frxUSD for staking on Base mainnet...`);
  const approveTx = await baseClient.sendTransaction({
    to: BASE_MAINNET_FRXUSD_ADDRESS,
    data: encodeFunctionData({
      abi: [
        {
          type: 'function',
          name: 'approve',
          stateMutability: 'nonpayable',
          inputs: [
            { name: 'spender', type: 'address' },
            { name: 'amount', type: 'uint256' },
          ],
          outputs: [{ name: '', type: 'bool' }],
        },
      ],
      functionName: 'approve',
      args: [BASE_MAINNET_HOP_ADDRESS, STAKE_AMOUNT],
    }),
  });
  console.log(`Base mainnet frxUSD Approval Tx: ${approveTx}`);
}
```

### 2. Stake frxUSD for sfrxUSD

After approving frxUSD, stake by calling the Hop contract's `mintRedeem` function to receive sfrxUSD:

```javascript
async function stakeFrxusd() {
  console.log(`Staking frxUSD for sfrxUSD on Base mainnet...`);
  const txHash = await baseClient.sendTransaction({
    to: BASE_MAINNET_HOP_ADDRESS,
    data: encodeFunctionData({
      abi: [
        {
          inputs: [
            { internalType: 'address', name: '_oft', type: 'address' },
            { internalType: 'uint256', name: '_amountLD', type: 'uint256' },
          ],
          name: 'mintRedeem',
          outputs: [],
          stateMutability: 'payable',
          type: 'function',
        },
      ],
      functionName: 'mintRedeem',
      args: [BASE_MAINNET_FRXUSD_ADDRESS, STAKE_AMOUNT],
    }),
  });
  console.log(`Base mainnet Stake Tx: ${txHash}`);
}
```

### 3. Approve sfrxUSD for unstaking

Before unstaking, approve sfrxUSD for the same contract so it can pull sfrxUSD:

```javascript
async function approveSfrxusdForUnstaking() {
  console.log(`Approving sfrxUSD for unstaking on Base mainnet...`);
  const approveTx = await baseClient.sendTransaction({
    to: BASE_MAINNET_SFRXUSD_ADDRESS,
    data: encodeFunctionData({
      abi: [
        {
          type: 'function',
          name: 'approve',
          stateMutability: 'nonpayable',
          inputs: [
            { name: 'spender', type: 'address' },
            { name: 'amount', type: 'uint256' },
          ],
          outputs: [{ name: '', type: 'bool' }],
        },
      ],
      functionName: 'approve',
      args: [BASE_MAINNET_HOP_ADDRESS, UNSTAKE_AMOUNT],
    }),
  });
  console.log(`Base mainnet sfrxUSD Approval Tx: ${approveTx}`);
}
```

### 4. Unstake sfrxUSD for frxUSD

After approving sfrxUSD, unstake by calling the sfrxUSD contract's `redeem` function to receive frxUSD back:

```javascript
async function unstakeSfrxusd() {
  console.log(`Unstaking sfrxUSD for frxUSD on Base mainnet...`);
  const txHash = await baseClient.sendTransaction({
    to: BASE_MAINNET_HOP_ADDRESS,
    data: encodeFunctionData({
      abi: [
        {
          inputs: [
            { internalType: 'address', name: '_oft', type: 'address' },
            { internalType: 'uint256', name: '_amountLD', type: 'uint256' },
          ],
          name: 'mintRedeem',
          outputs: [],
          stateMutability: 'payable',
          type: 'function',
        },
      ],
      functionName: 'mintRedeem',
      args: [BASE_MAINNET_SFRXUSD_ADDRESS, UNSTAKE_AMOUNT],
    }),
  });
  console.log(`Base mainnet Unstake Tx: ${txHash}`);
}
```

## Build the script

Create a `stake-and-unstake.js` file in your project directory and paste the following complete script:

### stake-and-unstake.js

```javascript
// ============ Setup (imports, account, clients) ============
import 'dotenv/config';
import { createWalletClient, http, encodeFunctionData } from 'viem';
import { privateKeyToAccount } from 'viem/accounts';
import { base } from 'viem/chains';

// ============ Configuration Constants ============

// Authentication
const PRIVATE_KEY = process.env.PRIVATE_KEY;
const account = privateKeyToAccount(`0x${PRIVATE_KEY}`);

// Hop Contract Address
const BASE_MAINNET_HOP_ADDRESS = '0x73382eb28F35d80Df8C3fe04A3EED71b1aFce5dE';

// frxUSD and sfrxUSD Contract Addresses
const BASE_MAINNET_FRXUSD_ADDRESS = '0xe5020A6d073a794B6E7f05678707dE47986Fb0b6';
const BASE_MAINNET_SFRXUSD_ADDRESS = '0x91A3f8a8d7a881fBDfcfEcd7A2Dc92a46DCfa14e';

// Staking Parameters
const STAKE_AMOUNT = 10_000_000_000_000_000_000n; // 10 frxUSD (18 decimals)
const UNSTAKE_AMOUNT = 10_000_000_000_000_000_000n; // 10 sfrxUSD (18 decimals)

// Wallet client
const baseClient = createWalletClient({
  chain: base,
  transport: http(BASE_RPC_URL),
  account,
});

// ============ Helper Functions ============

// 1) Approve frxUSD for staking
async function approveFrxusdForStaking() {
  console.log(`Approving frxUSD for staking on Base mainnet...`);
  const approveTx = await baseClient.sendTransaction({
    to: frxusdAddress,
    data: encodeFunctionData({
      abi: [
        {
          type: 'function',
          name: 'approve',
          stateMutability: 'nonpayable',
          inputs: [
            { name: 'spender', type: 'address' },
            { name: 'amount', type: 'uint256' },
          ],
          outputs: [{ name: '', type: 'bool' }],
        },
      ],
      functionName: 'approve',
      args: [sfrxusdAddress, amount],
    }),
  });
  console.log(`Base mainnet frxUSD Approval Tx: ${approveTx}`);
}

// 2) Stake frxUSD for sfrxUSD
async function stakeFrxusd() {
  console.log(`Staking frxUSD for sfrxUSD on Base mainnet...`);
  const txHash = await baseClient.sendTransaction({
    to: BASE_MAINNET_HOP_ADDRESS,
    data: encodeFunctionData({
      abi: [
        {
          inputs: [
            { internalType: 'address', name: '_oft', type: 'address' },
            { internalType: 'uint256', name: '_amountLD', type: 'uint256' },
          ],
          name: 'mintRedeem',
          outputs: [],
          stateMutability: 'payable',
          type: 'function',
        },
      ],
      functionName: 'mintRedeem',
      args: [BASE_MAINNET_FRXUSD_ADDRESS, STAKE_AMOUNT],
    }),
  });
  console.log(`Base mainnet Stake Tx: ${txHash}`);
}

// 3) Approve sfrxUSD for unstaking
async function approveSfrxusdForUnstaking() {
  console.log(`Approving sfrxUSD for unstaking on Base mainnet...`);
  const approveTx = await baseClient.sendTransaction({
    to: BASE_MAINNET_SFRXUSD_ADDRESS,
    data: encodeFunctionData({
      abi: [
        {
          type: 'function',
          name: 'approve',
          stateMutability: 'nonpayable',
          inputs: [
            { name: 'spender', type: 'address' },
            { name: 'amount', type: 'uint256' },
          ],
          outputs: [{ name: '', type: 'bool' }],
        },
      ],
      functionName: 'approve',
      args: [BASE_MAINNET_HOP_ADDRESS, UNSTAKE_AMOUNT],
    }),
  });
  console.log(`Base mainnet sfrxUSD Approval Tx: ${approveTx}`);
}

// 4) Unstake sfrxUSD for frxUSD
async function unstakeSfrxusd() {
  console.log(`Unstaking sfrxUSD for frxUSD on Base mainnet...`);
  const txHash = await baseClient.sendTransaction({
    to: BASE_MAINNET_HOP_ADDRESS,
    data: encodeFunctionData({
      abi: [
        {
          inputs: [
            { internalType: 'address', name: '_oft', type: 'address' },
            { internalType: 'uint256', name: '_amountLD', type: 'uint256' },
          ],
          name: 'mintRedeem',
          outputs: [],
          stateMutability: 'payable',
          type: 'function',
        },
      ],
      functionName: 'mintRedeem',
      args: [BASE_MAINNET_SFRXUSD_ADDRESS, UNSTAKE_AMOUNT],
    }),
  });
  console.log(`Base mainnet Unstake Tx: ${txHash}`);
}

// ============ Main ============
async function main() {
  // Staking flow
  await approveFrxusdForStaking();
  await stakeFrxusd();

  // Unstaking flow
  await approveSfrxusdForUnstaking();
  await unstakeSfrxusd();

  console.log('Staking and unstaking completed!');
}

main().catch(console.error);
```

## Test the script

To test the script, run the following command:

```shell
node stake-and-unstake.js
```

The script will execute staking and unstaking operations on **Base mainnet**, logging all transaction hashes to the console.

## What's next

- [Stake & Unstake frxUSD on Fraxtal](/frxusd/stake-and-unstake-quickstart-fraxtal)
